<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <!--[if lt IE 9]>
	<script type="text/javascript" src="https://raw.github.com/shawnbot/aight/master/aight.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/sizzle/1.4.4/sizzle.min.js"></script>
	<![endif]-->
        <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="calc.js"></script>
    
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  
  <body >
    <div class="header">
      <a class="logo" href="https://wawa.com" title="Wawa Logo">
        <img src="https://cdn.shopify.com/s/files/1/0833/8827/t/12/assets/logo.png?10795618602926747781"/></a>
      
      <div class="menus">
	<h1>NGrams That Lead To Positive Reviews At Food & Convenience Stores</h1>
	
      </div>
    </div>
    
    <div style="width: 1200px; margin:0 auto;">
      <div class="left">
		<table>
		  <tr>
			<td class="name" style="width: 150px">Pick 2 states to compare:</td>
			<td class="value">
			  <select id="inds1">
			<option value="AL">AL</option>
			<option value="AZ">AZ</option>
			<option value="IL">IL</option>
			<option value="NC">NC</option>
			<option value="NI">NI</option>
			<option value="NV">NV</option>
			<option value="NY">NY</option>
			<option value="OH">OH</option>
			<option value="ON">ON</option>
			<option value="OR">OR</option>
			<option value="PA" selected="selected">PA</option>
			<option value="SC">SC</option>
			<option value="WI">WI</option>
			  </select>
						</td>
			<td class="value">
			  <select id="inds2">
			<option value="AL">AL</option>
			<option value="AZ" selected="selected">AZ</option>
			<option value="IL">IL</option>
			<option value="NC">NC</option>
			<option value="NI">NI</option>
			<option value="NV">NV</option>
			<option value="NY">NY</option>
			<option value="OH">OH</option>
			<option value="ON">ON</option>
			<option value="OR">OR</option>
			<option value="PA">PA</option>
			<option value="SC">SC</option>
			<option value="WI">WI</option>
			  </select>
			</td>
		  </tr>
		</table>
		
		<table id="resultstable"></table>
      </div>
      <div class="right" style="text-align: left;">
	<div style="color: #888; padding: 4px; ">
	  <h3>Methodology</h3>
	  <p><b>UI Overview:</b> Can we learn from 5M Yelp to determine important qualities of convenience stores in different locales?  </p>
	  <p>The table on the left lits the most predictive ngrams for positive reviews of convenience stores in 13 states. The more positive the number then the more it predicts positive reviewsb. For example, if it's "clean", "nice" then the review is more likely to be positive and if there are issues with beer or the parking lot then the review is more likely to be negative.  The table is sorted so that the leftmost column is sorted top-to-bottom (most positive to most negative) and the rightmost column is set up to show comparisons with another geography.</p>
	  <p>The light red table (below) will list example reviews for keywords in the left table which are underlined with blue text. That sample would expand to cover all with more compute resources.  </p>

	  <p><b>Usage:</b> This kind of tool could help you <ul><li>... plan for launching new stores in unfamiliar locales. It can also be paired with more location data (e.g. from yelp or GIS sources) to add neighborhood information, highlight areas that are trending downwards in reviews.</li> <li>... identify unmet needs with regards to product selection or store features.</li> <li>... add fidelity to existing marketing segmentation models or perform qualitative-like information gathering on large scale.</li></ul>  </p>

	  <p><b>Data:</b> Comes from the <a href="https://www.kaggle.com/yelp-dataset/yelp-dataset/home">Kaggle Yelp dataset</a> filtered by reviews in categories of "food" and "convenience store" </p>
	  <p><b>ML/AI/NLP details:</b> Multinomial Naive Bayes text classification model with ngrams of size (1,3) after removing stopwords and non-alphanumeric words. </p>

	  <p><b>Technology:</b> Python (scikit-learn, numpy). Javascript (D3, jquery).</p>
	</div>

	<div class="reviewhighlights">
	  <h3>Example Reviews (click on linked ngrams on left)</h3>
	  <p>If I had compute (e.g. a Lambda) then we could display example reviews for all ngrams or better yet use Elastic/SOLR to return searh results. It's too much data to put into one static html file.  </p>

	  <div id = "doubleclick">
	  </div>
	</div>

      </div>
    </div>
    
    <script type="text/javascript">
      var chartWidth = "100px",
      percent = d3.format(".2%");
      orig_data = []
      //draw_chart(orig_data, 11, 2);

         d3.csv('words.csv', function loadCallback(error, data) {
                data.forEach(function(d) { 
      d.AL = +d.AL;
      d.AZ = +d.AZ;
      d.IL = +d.IL;
      d.NC = +d.NC;
      d.NI = +d.NI;
      d.NV = +d.NV;
      d.NY = +d.NY;
      d.OH = +d.OH;
      d.ON = +d.ON;
      d.OR = +d.OR;
      d.PA = +d.PA;
      d.SC = +d.SC;
      d.WI = +d.WI;
		});
	        orig_data = data;
                draw_chart(data, 'PA', 'AZ');
            });

d3.select('#inds1')
    .on("change", function () {
	var sect = document.getElementById("inds1");
	var section = sect.options[sect.selectedIndex].value;

	var sect2 = document.getElementById("inds2");
	var section2 = sect2.options[sect2.selectedIndex].value;

	//debugger
	draw_chart(orig_data,section, section2);
    });

d3.select('#inds2')
    .on("change", function () {
	var sect = document.getElementById("inds1");
	var section = sect.options[sect.selectedIndex].value;

	var sect2 = document.getElementById("inds2");
	var section2 = sect2.options[sect2.selectedIndex].value;

	//debugger
	draw_chart(orig_data,section, section2);
    });


    </script>
  </body>
</html>
